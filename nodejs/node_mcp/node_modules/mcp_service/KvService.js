var dc = require('mcp_db').dc;

var KvService = function(){};

KvService.prototype.getPrintSeqId = function(cb)
{
    var kvTable = dc.mg.get("mcp_id");
    var id = "print_seq";
    kvTable.findAndModify({_id:id}, {}, {$inc:{value:1}}, {upsert:true, new:true}, function(err, data){
        cb(err, data);
    });
};

KvService.prototype.getOrderId = function(cb)
{
    var kvTable = dc.mg.get("mcp_id");
    var id = "orderId";
    kvTable.findAndModify({_id:id}, {}, {$inc:{value:1}}, {upsert:true, new:true}, function(err, data){
        cb(err, data);
    });
};

KvService.prototype.getNotifyQueenId = function(cb)
{
    var kvTable = dc.mg.get("mcp_id");
    var id = "notify_queen_id";
    kvTable.findAndModify({_id:id}, {}, {$inc:{value:1}}, {upsert:true, new:true}, function(err, data){
        cb(err, data);
    });
};

module.exports = new KvService();